<div class="auth-container">
    <div class="auth-card">
        <div class="text-center">
            <h1 class="h2 mb-4">Reset Your Password</h1>
            <p class="text-body-secondary mb-4">Please enter and confirm your new password below.</p>
        </div>

        <% if (typeof error !== 'undefined' && error) { %>
            <div class="alert alert-danger text-center" role="alert">
              <%= error %>
            </div>
        <% } %>
         
        <form action="/password/reset/<%= token %>" method="POST">
            <div class="mb-3">
              <label for="password" class="form-label">New Password</label>
              <input type="password" class="form-control form-control-lg" id="password" name="password" required>
              <ul class="password-criteria">
                  <li id="length-check"><span class="iconify"></span>At least 8 characters</li>
                  <li id="upper-check"><span class="iconify"></span>One uppercase letter</li>
                  <li id="lower-check"><span class="iconify"></span>One lowercase letter</li>
                  <li id="number-check"><span class="iconify"></span>One number</li>
                  <li id="special-check"><span class="iconify"></span>One special character</li>
              </ul>
            </div>
     
            <div class="mb-3">
              <label for="confirm" class="form-label">Confirm New Password</label>
              <input type="password" class="form-control form-control-lg" id="confirm" name="confirm" required>
            </div>
            
            <div class="d-grid mb-3">
                <button type="submit" class="btn btn-primary btn-lg">Set New Password</button>
            </div>
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const passwordInput = document.getElementById('password');

        const checks = {
            length: { el: document.getElementById('length-check'), regex: /.{8,}/ },
            upper: { el: document.getElementById('upper-check'), regex: /[A-Z]/ },
            lower: { el: document.getElementById('lower-check'), regex: /[a-z]/ },
            number: { el: document.getElementById('number-check'), regex: /[0-9]/ },
            special: { el: document.getElementById('special-check'), regex: /[!@#$%^&*()_\+\-=\[\]{};':"\\|,.<>\/?`~]/ }
        };

        const validate = () => {
            const password = passwordInput.value;
            for (const key in checks) {
                const check = checks[key];
                const icon = check.el.querySelector('.iconify');
                
                if (check.regex.test(password)) {
                    check.el.classList.remove('invalid');
                    check.el.classList.add('valid');
                    icon.dataset.icon = 'material-symbols:check-circle-outline-rounded';
                } else {
                    check.el.classList.remove('valid');
                    check.el.classList.add('invalid');
                    icon.dataset.icon = 'material-symbols:cancel-outline-rounded';
                }
            }
        };

        passwordInput.addEventListener('input', validate);
        validate();
    });
</script>